---
import HomeLayout from '../layouts/HomeLayout.astro'
import PostCard from '../components/feed/PostCard.astro'
import Pagination from '../components/feed/Pagination.astro'
import { getAllPosts } from '../lib/content'

const POSTS_PER_PAGE = 8
const posts = await getAllPosts()
const pagePosts = posts.slice(0, POSTS_PER_PAGE)
const totalPages = Math.max(1, Math.ceil(posts.length / POSTS_PER_PAGE))
const BASE = (import.meta.env.BASE_URL || '/').replace(/\/+$/, '/')
---

<HomeLayout
  title="Kyon — Prozesse sichtbar machen"
  intro="Prozess statt Pose. Natürlichkeit vor Methode."
>
  {pagePosts.map((p) => <PostCard post={p} />)}
  <Fragment slot="pagination">
    <Pagination page={1} pages={totalPages} base={`${BASE}page`} />
  </Fragment>
</HomeLayout>
